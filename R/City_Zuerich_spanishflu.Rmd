---
title: "Past Pandemics City Zuerich"
author: "Katarina Matthes"
date: "`r Sys.Date()`"
output:
  rmdformats::robobook:
    code_folding: show
    self_contained: true
    highlight: pygments
editor_options: 
  chunk_output_type: console
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r set-options, echo=FALSE, cache=FALSE}
options(width = 2000)
```

# Epidemic curves
<!-- # Methods -->

<!-- # Weekly data -->

<!-- * To estimate the weekly population data, linear interpolation between the yearly population was performed. -->
<!-- * Incidence and mortality per 100'000 inhabitants -->

<!-- ## Results -->

```{r, echo=FALSE, warning=FALSE, fig.height =45 , fig.width = 25,message=FALSE}
function_plot_weekly_spa()
```


```{r, echo=FALSE, warning=FALSE, fig.height =6 , fig.width = 15,message=FALSE}
function_plot_swiss_re_spa()
```

# Interventions
```{r echo=FALSE, out.width = '100%'}
knitr::include_graphics("../data/Tabelle Interventionen.png")
```

# Reporting delays
<!-- ```{r echo=FALSE, out.width = '100%'} -->
<!-- knitr::include_graphics("../data/Reporting.png") -->
<!-- ``` -->


## Course of disease vs. reporting

```{r, echo=FALSE, warning=FALSE, fig.height =8 , fig.width = 15,message=FALSE}
funtion_dis_delay()
```

## Proportions of the reporting


```{r, echo=FALSE, warning=FALSE, fig.height =8 , fig.width = 8,message=FALSE}
funtion_heatmap_delay("Faelle")
```

```{r, echo=FALSE, warning=FALSE, fig.height =8 , fig.width = 8,message=FALSE}
funtion_heatmap_delay("Totesfaelle")
```


# Reproductions numbers
* R packages R0 (https://cran.r-project.org/web/packages/R0/index.html)
* time steps = 7 days (since weekly data)
* mean serial interval = 3 days
* sd of mean serial interval = 1 day
* gamma distribution (mean=3, sd=1) for the generation time -  selected on the basis of previous studies estimating R0 of Spanish flu
* exponential growth period:
  -  Wave 1: 4 weeks (28 days)
  -  Wave 2 CW 36-38: 2 weeks (14 days) 
  -  Wave 2 CW 40-42: 2 weeks (14 days) 
  -  Wave 3: 5 weeks (35 days)

<!-- ## Time serial interval 4.0 days  -->
```{r, echo=FALSE, warning=FALSE, fig.height =8 , fig.width = 15,message=FALSE}
function_reproductive_table("medium")%>%
  kbl(caption = "Serial interval 3  days") %>%
  kable_classic(full_width = F, html_font = "Cambria")
```



# Relative incidence rate ratio (RIRR)
Adapted from Staub K, JÃ¼ni P, et al. Public health interventions, epidemic growth, and regional variation of the
1918 influenza pandemic outbreak in a Swiss canton and its greater regions. Ann Intern, https://doi.org/10.7326/M20-6231

* $RIRR_{i} = (d_{i}/d_{i-1})/(d_{i-1}/d_{i-2})$  where $d_{i}$ is the number of cases during week i, $d_{i-1}$ the number of cases during week i-1, and $d_{i-2}$ the number cases during week i-2
* Standard error: $SE_{i}= \sqrt(1/d_{i} + 4/d_{i-1} + 1/d_{i-2})$
* 95% confidence interval of ln(RIRRi) is $ln(RIRRi) \pm 1.96 * SE_{i}$
* The calculations were made one week after the introduction of the enactment. Except in cases where reporting delays were greater than 1 week (see also figure "Course of disease vs. reporting")
<br >
<br >
An RIRR greater than 1 indicates an acceleration of epidemic growth, whereas an RIRR less than 1 indicates a deceleration.

## Canton Zurich
```{r echo=FALSE, out.width = '100%'}
knitr::include_graphics("../output/RRIR_Canton.png")
```


## City of Zurich
```{r echo=FALSE, out.width = '100%'}
knitr::include_graphics("../output/RRIR_City.png")
```

